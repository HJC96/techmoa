# Infra Improvements

## 최근 반영 이력
### 2026-02-21. IP 접속 시 도메인 HTTPS 강제 리다이렉트
1. 리다이렉트 정책 정리
- `frontend/nginx.conf`에서 기본 80 서버(`default_server`)를 추가해 IP/기타 호스트 접속을 모두 `https://techmoa.today`로 리다이렉트
2. Nginx 구성 단순화
- 중복된 80/443 블록을 정리해 `80 리다이렉트 1개 + 443 서비스 1개 + 443 정규화 리다이렉트 1개` 구조로 최적화
3. 도메인/IP 정규화
- `www.techmoa.today`, `43.202.208.107` 접근을 `https://techmoa.today`로 통일
4. API 프록시 유지
- HTTPS 서버의 `/api` 프록시(`techmoa-backend:8080`)는 기존 동작 유지

## 1. 네트워크/보안 구성 개선
1. 리버스 프록시 적용
- 외부 노출은 80 포트 중심으로 단순화하고 백엔드 직접 노출(8080) 최소화
2. 보안 그룹 정리
- 서비스 운영에 필요한 포트만 허용하고 불필요 포트 차단
3. 비밀값 관리 강화
- 관리자 계정/패스워드 기본값 제거 및 환경별 주입 절차 표준화

완료 기준
- 외부 노출 포트 최소화 및 비밀값 기본값 제거 확인

## 2. 배포 신뢰성 강화
1. 배포 체크리스트 운영
- 배포 전/후 헬스체크, 주요 API 점검, 롤백 기준 고정
2. Docker Compose 운영 표준화
- 서비스별 환경 변수 및 기동 순서 문서화
3. 빌드/배포 검증 루틴 정착
- `docker-compose up -d --build` 후 핵심 경로 검증 절차 고정

완료 기준
- 배포 실패 시 즉시 롤백 가능한 기준과 절차가 문서화됨

## 3. 데이터 복구 가능성 확보
1. PostgreSQL 백업 정책 수립
- 주기, 보관 기간, 백업 대상 명확화
2. 복구 리허설 수행
- 복구 시간, 검증 방법, 결과 기록까지 포함
3. 운영 모니터링 연결
- 장애 징후(수집 실패율, API 지연 등) 알림 기준 설정

완료 기준
- 백업/복구 리허설 결과와 운영 기록이 남아 있음
